<% is_owner = @user.id == current_user.id %>

<h1><%= @user.username %>'s Personal Page</h1>

<h2>Public Goals</h2>
<ul>
	<% @goals.each do |goal| %>
	<% next unless goal.viewable_by_others%>
	<li>
		<%= link_to (goal.completed ? "Completed: #{goal.title}" : goal.title), goal_url(goal) %>
		<%= render "updategoals", :goal => goal if is_owner %>
	</li>
	<% end %>
</ul>

<% if is_owner %>

<h2>Private Goals</h2>
<ul>
	<% @goals.each do |goal| %>
	<% next if goal.viewable_by_others %>
	<li>
		<%= goal.completed ? "Completed: #{goal.title}" : goal.title %>
		<%= render "updategoals", :goal => goal %>
	</li>
	<% end %>
</ul>

	<%= link_to "Add Goal", new_user_goal_url(@user) %>
<% end %>

<hr>

<h2>Comments</h2>
<ul>
	<% @user_comments.each do |user_comment| %>
		<li><%= "#{user_comment.author.username}: #{user_comment.body}" %></li>
	<% end %>
</ul>
<form action="<%= user_user_comments_url(@user) %>" method="post">

	<input type="hidden" name="authenticity_token"
		value="<%= form_authenticity_token %>">

	<label for="body">Comment:</label>
	<input type="text" name="comment[body]" value="" id="body">

	<p><input type="submit" value="Submit Comment"></p>
</form>